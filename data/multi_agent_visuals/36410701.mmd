flowchart TD
    %% Data Sources
    A[Training Data - Malware Images <img src='icons/image.svg' width=100 height=100/>] -->|Load using ImageDataGenerator| B[batches <img src='icons/column_split.svg' width=100 height=100/>]
    A2[Validation Data - Malware Images <img src='icons/image.svg' width=100 height=100/>] -->|Load using ImageDataGenerator| B

    %% Data Variables
    B -->|Retrieve Image and Label Batches| C[imgs <img src='icons/column_split.svg' width=100 height=100/>]
    B -->|Retrieve Image and Label Batches| D[labels <img src='icons/column_split.svg' width=100 height=100/>]
    
    C -->|Normalize and Split| E[x_train <img src='dummy_plots/barplot_template.svg'/>]
    D -->|Normalize and Split| F[y_train <img src='dummy_plots/barplot_template.svg'/>]
    C -->|Split for Testing| G[x_test]
    D -->|Split for Testing| H[y_test]

    %% ML Model
    E -->|Train CoAtNet Model| I[CoAtNet Model <img src='dummy_plots/barplot_template.svg'/>]
    F -->|Train CoAtNet Model| I
    
    I -->|Predict on Test Data| J[pred_x]
    J -->|Derive Predicted Labels| K[y_pred]

    %% Confusion Matrix
    H -->|Compare with Predictions| L[c_matrix <img src='dummy_plots/barplot_template.svg'/>]
    K -->|Compare with Test Labels| L