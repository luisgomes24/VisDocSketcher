flowchart TD
    %% Data Sources
    A1["train.csv"] --> B1
    A2["test.csv"] --> B2
    A3["sample_submission.csv"] --> B3

    %% Data Loading and Preprocessing
    B1["train DataFrame"]
    B2["test DataFrame"]
    B3["sample DataFrame"]

    B1 --> C1["Split into xtrain and y"]
    B1 --> C2["Split into xval and yval"]

    %% Model Training and Evaluation
    C1 --> D1["xtrain"]
    C1 --> D2["ytrain"]
    C2 --> D3["xval"]
    C2 --> D4["yval"]

    D1 & D2 --> E1["RandomForestRegressor Model Training"]
    E1 --> E2["Model Evaluation with xval and yval"]

    %% Predictions
    E1 --> F1["Make Predictions: ypred on test DataFrame"]

    %% Output Preparation
    F1 --> G1["Add Predictions to sample DataFrame"]
    G1 --> H1["Export to CSV for Submission"]

    %% Comments for each node
    classDef dataNode fill:#f9f,stroke:#333,stroke-width:2px;
    classDef processNode fill:#bbf,stroke:#333,stroke-width:2px;
    classDef outputNode fill:#bfb,stroke:#333,stroke-width:2px;

    class A1,A2,A3 dataNode;
    class B1,B2,B3,C1,C2,F1,G1,H1 processNode;
    class D1,D2,D3,D4,E1,E2 outputNode;
