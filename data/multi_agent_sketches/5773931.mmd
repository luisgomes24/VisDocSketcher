flowchart TD
    %% Data Source Node
    A["../input/hymenoptera-data/hymenoptera_data"]
    click A href "../input/hymenoptera-data/hymenoptera_data" "Data source directory"
    
    %% Data Variables Nodes
    B[path]
    C[il]
    D[sd]
    E[ll]
    F[data]
    G[learn]
    H[pred]
    I[truth]
    
    %% Data Processing and Flow
    A -->|"Initialize Path"| B["Path instance
    Used to list files and directories"]
    B -->|"Create ImageList"| C["ImageList
    Created from folder of images"]
    C -->|"Split by folder"| D["SplitData
    Train and validation datasets"]
    D -->|"Label from folder"| E["LabelList
    Contains labels for classification"]
    E -->|"DataBunch and Transform"| F["DataBunch
    Normalized data ready for training"]
    F -->|"Create Learner"| G["Learner
    CNN with resnet18"]
    
    %% Learning Process
    G -->|"Train model"| G
    
    %% Predictions
    G -->|"Get Predictions"| H["Predictions
    Generated by the model"]
    G -->|"True Labels"| I
    
    %% Model Information
    classDef model fill:#f96,stroke:#333,stroke-width:2px;
    G:::model
    style G stroke:#f66,stroke-width:4px;
    
    %% Comments for clarity
    classDef dataVar fill:#bbf,stroke:#00f,stroke-width:1px;
    class B,C,D,E,F,H,I dataVar;
    %% Each node represents a step in handling data and label management
    linkStyle 0 stroke-width:2px,fill:none,stroke-dasharray: 5,5;